# EgressIP Performance Analyzer Configuration
# Following the repository's configuration patterns

# Test Configuration
test_config:
  # CORENET-6498 Test Defaults
  cornet_6498:
    default_eip_objects: 10
    default_pods_per_eip: 200
    default_iterations: 20
    default_timeout_minutes: 360
    supported_platforms:
      - "aws"
      - "gcp" 
      - "azure"
      - "openstack"
      - "vsphere"
      - "baremetal"
      - "nutanix"
      - "powervs"
    supported_ip_stacks:
      - "ipv4single"
      - "ipv6single"
      - "dualstack"
    
  # Resource Limits
  resource_limits:
    max_eip_objects: 50
    max_pods_per_eip: 1000
    max_iterations: 100
    max_test_duration_hours: 12
    
  # Validation Settings
  validation:
    min_worker_nodes: 3
    required_network_type: "OVNKubernetes"
    check_cluster_resources: true
    skip_on_special_clusters: true

# OVN Analysis Configuration
ovn_analysis:
  # Rule Collection Settings
  collection:
    timeout_seconds: 60
    retry_attempts: 3
    retry_delay_seconds: 5
    
  # Monitoring Settings
  monitoring:
    default_duration_seconds: 300
    check_interval_seconds: 30
    max_snapshots: 1000
    
  # Consistency Thresholds
  thresholds:
    consistency_score_warning: 0.5
    consistency_score_critical: 0.3
    max_parsing_errors: 10
    max_missing_rules: 5

# Metrics Collection Configuration
metrics:
  # Database Settings
  database:
    path: "./storage/egress_metrics.db"
    backup_enabled: true
    backup_interval_hours: 24
    retention_days: 30
    
  # Collection Schedule
  collection_schedule:
    egressip_metrics_interval_minutes: 15
    ovn_rules_interval_minutes: 30
    cluster_metrics_interval_minutes: 60
    
  # Trend Analysis
  trend_analysis:
    default_lookback_days: 7
    trend_threshold_percent: 10
    min_data_points: 5

# Performance Thresholds
performance_thresholds:
  # Test Execution Times
  test_execution:
    cornet_6498_max_hours: 6
    scenario_max_minutes: 60
    node_reboot_max_minutes: 10
    
  # Rule Validation
  rule_validation:
    max_snat_rules_per_node: 10000
    max_lrp_rules_per_node: 50000
    rule_consistency_min_score: 0.8
    
  # Cluster Resources
  cluster_resources:
    min_available_memory_gb: 64
    min_available_cpu_cores: 16
    max_cluster_utilization_percent: 80

# Error Handling and Retry Configuration
error_handling:
  # Retry Settings
  retry:
    max_attempts: 3
    exponential_backoff: true
    base_delay_seconds: 2
    max_delay_seconds: 60
    
  # Timeout Settings
  timeouts:
    kubectl_command_seconds: 120
    ovn_command_seconds: 60
    cluster_operation_seconds: 300
    
  # Failure Handling
  failure_handling:
    continue_on_non_critical_errors: true
    stop_on_cluster_instability: true
    cleanup_on_failure: true

# Integration Settings
integration:
  # External Tools
  tools:
    kubectl_path: "oc"
    ginkgo_path: "ginkgo"
    go_path: "go"
    
  # Cluster Access
  cluster:
    kubeconfig_env_var: "KUBECONFIG"
    verify_cluster_access: true
    required_permissions:
      - "nodes:list"
      - "egressips:list,create,delete"
      - "pods:list,create,delete"
      - "namespaces:create,delete"
    
  # Test Environment
  test_environment:
    base_test_dir: "/home/sninganu/egress"
    temp_dir_prefix: "egressip_test_"
    cleanup_temp_dirs: true

# Reporting Configuration
reporting:
  # Output Formats
  formats:
    json_enabled: true
    text_enabled: true
    html_enabled: false
    
  # Report Content
  content:
    include_raw_output: true
    include_debug_info: false
    max_raw_output_chars: 5000
    
  # Storage
  storage:
    reports_directory: "./analysis/egress/reports"
    retain_reports_days: 30
    compress_old_reports: true

# Security Configuration
security:
  # Data Protection
  data_protection:
    mask_sensitive_data: true
    log_sanitization: true
    
  # Access Control
  access_control:
    require_cluster_admin: false
    allowed_namespaces: []  # Empty means all namespaces

# Feature Flags
feature_flags:
  enable_ipv6_testing: true
  enable_dual_stack_testing: true
  enable_performance_monitoring: true
  enable_trend_analysis: true
  enable_automated_cleanup: true
  enable_experimental_features: false